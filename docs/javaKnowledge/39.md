# 四层/七层负载均衡

## 作用

1、可以提高吞吐量，提高服务性能，以及服务器的处理性能；

2、可以提高服务器计算能力，使网络设备更加灵活

3、当并发大量请求的时候，负载均衡可以将请求分配到计算机的多个节点上，从而减轻服务器的并发压力

## 介绍

### 四层负载均衡 (传输层  : TCP/UDP) (常用 LVS)

#### 概念

四层负载均衡是基于IP+端口的负载均衡

#### 原理

通过转发请求到后台服务器

#### 长连接

记录当前请求是由那一台服务器处理的，并且之后这个客户端发送的请求将会由这台服务器处理

#### F5负载均衡

基于硬件的硬负载均衡，功能强，性能高，稳定性好，贵，商业级别的负载均衡；

#### LVS四层负载均衡

Linux内核的四层负载，和协议无关，可以用于转发请求

#### Haproxy

四层负载均衡，灵活性高，也可以做七层负载均衡

#### Nginx四层负载均衡

新版本也可以做四层负载均衡

* 一般来说还是做七层负载均衡，主要是基于http的一个负载均衡

* 在nginx1.9版本后，新增了一个基于stream的四层负载均衡

### 七层负载均衡 （基本用语处理http协议的） (常用Nginx)

#### 概念

基于url/IP的负载均衡;基于应用层，基于http协议的负载均衡

#### Nginx七层负载均衡

对Http协议/mail协议做负载转发

#### Haproxy

四层/七层的负载转发功能

#### apache

性能不如nginx高，并发达到百万级别性能会越来越差;

## 对比

### 七层: (售票处: 可以根据用户需求处理； 售票处需要提供一些 "身份信息")

* 适用于web服务器(Tomcat、Apache)

* 七层会处理请求，Nginx可以处理(压缩,缓存) js\css等这些内容

### 四层: (黄牛，只会把票卖你)

* 适用处理基于TCP/UDP转发请求

* 四层主要是转发请求，不会进程处理

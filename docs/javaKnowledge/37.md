# java项目打包部署

## 打包

### 普通java项目

#### war

1、在pom.xml里添加packaging

```xml
<packaging>war</packaging>
```

2、点击项目运行按钮，运行完成后打开target文件夹，找到项目名.war文件

![Image text](../public/javaKnowledge/37/01.png)

### springBoot项目

#### war

以[foodie-dev/dev-mybatis-plus](https://github.com/zhaobao1830/foodie-dev)为例

1、在pom.xml(foodie-dev-api)里添加packaging

```xml
<packaging>war</packaging>
```

2、在pom.xml(foodie-dev)去掉springBoot项目自带的tomcat依赖

```
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-web</artifactId>
    <!-- 打包war [2] 移除自带内置tomcat -->
    <exclusions>
        <exclusion>
            <artifactId>spring-boot-starter-tomcat</artifactId>
            <groupId>org.springframework.boot</groupId>
        </exclusion>
    </exclusions>
</dependency>
```

3、由于第2步去掉了tomcat依赖，里面的servlet依赖也没有了，在pom.xml(foodie-dev)添加servlet依赖

```xml
<!-- 打包war [3] 添加依赖 -->
<dependency>
    <groupId>javax.servlet</groupId>
    <artifactId>javax.servlet-api</artifactId>
    <scope>provided</scope>
</dependency>
```

4、新建关于war的依赖类

```java
package com.zb;

import org.springframework.boot.builder.SpringApplicationBuilder;
import org.springframework.boot.web.servlet.support.SpringBootServletInitializer;

// 打包war [4] 增加war的启动类
public class WarStarterApplication extends SpringBootServletInitializer {

    @Override
    protected SpringApplicationBuilder configure(SpringApplicationBuilder builder) {
        // 指向Application这个springboot启动类
        return builder.sources(Application.class);
    }
}

```

5、先执行maven里的clean，再执行install，执行成功后，在target文件夹找到生成的war包

![Image text](../public/javaKnowledge/37/02.png)

![Image text](../public/javaKnowledge/37/03.png)

## 部署

### tomcat

1、将上面打包生成的war包放到tomcat的webapps文件下，启动tomcat，就会自动解压

![Image text](../public/javaKnowledge/37/04.png)

2、通过端口+项目名字访问对应接口

![Image text](../public/javaKnowledge/37/03.png)


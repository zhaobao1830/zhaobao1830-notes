import{_ as s,o as a,c as n,R as p}from"./chunks/framework.1nBpG9uI.js";const e="/zhaobao1830-notes/assets/01.5tDqIvwT.png",l="/zhaobao1830-notes/assets/02.S3OM33cN.png",t="/zhaobao1830-notes/assets/03.g_uKdfI9.png",_=JSON.parse('{"title":"uniapp打包项目","description":"","frontmatter":{},"headers":[],"relativePath":"uniappNotes/07.md","filePath":"uniappNotes/07.md","lastUpdated":1707119144000}'),i={name:"uniappNotes/07.md"},r=p('<h1 id="uniapp打包项目" tabindex="-1">uniapp打包项目 <a class="header-anchor" href="#uniapp打包项目" aria-label="Permalink to &quot;uniapp打包项目&quot;">​</a></h1><h2 id="打包web" tabindex="-1">打包web <a class="header-anchor" href="#打包web" aria-label="Permalink to &quot;打包web&quot;">​</a></h2><p>1、点击scr下的manifest.json</p><p><img src="'+e+'" alt="Image text"></p><p>配置路由模式和运行的基础路径</p><p>（1）、路由模式可以选择hash和history俩种，如果是history，部署的时候需要进行额外的配置，可以参考这个文章：<a href="https://zhaobao1830.github.io/zhaobao1830-notes/java/nginx/01.html#%E6%96%87%E4%BB%B6%E9%85%8D%E7%BD%AE" target="_blank" rel="noreferrer">nginx配置</a></p><p>加一行代码：try_files $uri $uri/ /index.html;</p><p>（2）、运行的基础路径默认是h5，打包以后项目所在的文件夹就是h5，如果是其他的文件名称，比如dist，那就进行修改成/dist/</p><p>2、点击发行--网站-PC Web或手机H5</p><p><img src="'+l+'" alt="Image text"></p><p>网站标题可以用默认的，也可以自己修改</p><p>3、配置完成后点击发行按钮，生成打包文件</p><p><img src="'+t+`" alt="Image text"></p><h2 id="部署" tabindex="-1">部署 <a class="header-anchor" href="#部署" aria-label="Permalink to &quot;部署&quot;">​</a></h2><p>h5文件夹里的文件就是uniapp打包h5后的文件，将其改名为apph5（这个名字必须和打包时候填写的运行的基础路径一致）</p><h3 id="tomcat" tabindex="-1">tomcat <a class="header-anchor" href="#tomcat" aria-label="Permalink to &quot;tomcat&quot;">​</a></h3><p>将apph5放到webapps文件夹，点击bin/startup.bat启动tomcat，在url里输入<code>http://localhost:8080/apph5/</code> 即可访问项目</p><div class="tip custom-block"><p class="custom-block-title">备注</p><p>路由模式为history模式打包的项目，刷新会报404，解决办法是在打包后的项目根目录新建<code>WEB-INF</code>文件夹， 在里面添加web.xml文件， web.xml文件的内容为：</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span>
<span class="line"><span>&lt;web-app xmlns=&quot;http://xmlns.jcp.org/xml/ns/javaee&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span>
<span class="line"><span>  xsi:schemaLocation=&quot;http://xmlns.jcp.org/xml/ns/javaee</span></span>
<span class="line"><span>           http://xmlns.jcp.org/xml/ns/javaee/web-app_3_1.xsd&quot;</span></span>
<span class="line"><span>  version=&quot;3.1&quot; metadata-complete=&quot;true&quot;&gt;</span></span>
<span class="line"><span>  &lt;display-name&gt;Router for Tomcat&lt;/display-name&gt;</span></span>
<span class="line"><span>  &lt;error-page&gt;</span></span>
<span class="line"><span>    &lt;error-code&gt;404&lt;/error-code&gt;</span></span>
<span class="line"><span>    &lt;location&gt;/index.html&lt;/location&gt;</span></span>
<span class="line"><span>  &lt;/error-page&gt;</span></span>
<span class="line"><span>&lt;/web-app&gt;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><p>这样刷新页面会正常显示，但会在控制台输出找不到页面（404）</p></div><h3 id="nginx" tabindex="-1">nginx <a class="header-anchor" href="#nginx" aria-label="Permalink to &quot;nginx&quot;">​</a></h3><p>将apph5文件夹放到nginx的nginxRun文件夹下，执行start nginx命令启动nginx</p><p>在url输入<code>http://192.168.3.30:92/apph5/</code> 打开项目</p><p>nginx配置文件</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>server {</span></span>
<span class="line"><span>            # 监听端口</span></span>
<span class="line"><span>            listen       92;</span></span>
<span class="line"><span>            #ip、备案过的域名、localhost</span></span>
<span class="line"><span>            server_name  192.168.3.30;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>            # 存储路径是E:/nginx-1.22.1/nginxRun/apph5/</span></span>
<span class="line"><span>            # 请求路由映射，匹配拦截</span></span>
<span class="line"><span>            location ^~ /apph5/ {</span></span>
<span class="line"><span>                # 解决history模式下，刷新报错的bug</span></span>
<span class="line"><span>                try_files $uri $uri/ /apph5/index.html;</span></span>
<span class="line"><span>                # 请求位置</span></span>
<span class="line"><span>                root   E:/nginx-1.22.1/nginxRun;</span></span>
<span class="line"><span>                # 首页位置</span></span>
<span class="line"><span>                index  index.html;</span></span>
<span class="line"><span>            }</span></span>
<span class="line"><span>        }</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">备注</p><p>url的访问路径，最后必须加上/，不然请求不到项目</p></div><div class="tip custom-block"><p class="custom-block-title">备注</p><p>history模式，必须加上 <code>try_files $uri $uri/ /apph5/index.html;</code> 不然刷新会报404错误</p><p>因为访问的项目是在apph5文件夹下，所以<code>try_files $uri $uri/ /apph5/index.html;</code> 应该加上/apph5</p></div>`,25),o=[r];function c(u,b,m,h,d,g){return a(),n("div",null,o)}const v=s(i,[["render",c]]);export{_ as __pageData,v as default};

import{_ as s,o as a,c as n,R as i}from"./chunks/framework.1nBpG9uI.js";const e="/zhaobao1830-notes/assets/01.Q4OVQLKy.png",p="/zhaobao1830-notes/assets/02.Cheeje90.png",g=JSON.parse('{"title":"nginx将vue项目部署在二级目录下","description":"","frontmatter":{},"headers":[],"relativePath":"vueNotes/32.md","filePath":"vueNotes/32.md","lastUpdated":1718936506000}'),l={name:"vueNotes/32.md"},t=i(`<h1 id="nginx将vue项目部署在二级目录下" tabindex="-1">nginx将vue项目部署在二级目录下 <a class="header-anchor" href="#nginx将vue项目部署在二级目录下" aria-label="Permalink to &quot;nginx将vue项目部署在二级目录下&quot;">​</a></h1><h2 id="需求" tabindex="-1">需求 <a class="header-anchor" href="#需求" aria-label="Permalink to &quot;需求&quot;">​</a></h2><p>将vue项目打包，部署在nginx服务器中的二级目录下，同一个请求地址进入，通过在Url后加不同的路径，打开不同的项目</p><p>比如请求地址是：<a href="http://192.168.4.103:100" target="_blank" rel="noreferrer">http://192.168.4.103:100</a>，当输入<a href="http://192.168.4.103:100" target="_blank" rel="noreferrer">http://192.168.4.103:100</a>，打开dist项目，输入<a href="http://192.168.4.103:100/paasui%EF%BC%8C%E6%89%93%E5%BC%80paasui%E9%A1%B9%E7%9B%AE%EF%BC%8C" target="_blank" rel="noreferrer">http://192.168.4.103:100/paasui，打开paasui项目，</a> 输入<a href="http://192.168.4.103:100/admin%EF%BC%8C%E6%89%93%E5%BC%80admin%E9%A1%B9%E7%9B%AE" target="_blank" rel="noreferrer">http://192.168.4.103:100/admin，打开admin项目</a></p><h2 id="打包项目" tabindex="-1">打包项目 <a class="header-anchor" href="#打包项目" aria-label="Permalink to &quot;打包项目&quot;">​</a></h2><h3 id="vue-cli脚手架" tabindex="-1">vue-cli脚手架 <a class="header-anchor" href="#vue-cli脚手架" aria-label="Permalink to &quot;vue-cli脚手架&quot;">​</a></h3><p>1、修改vue.config.js中的publicPath</p><p>如果项目部署在根目录下，值为&quot;./&quot;</p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 公共路径(必须有的)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  publicPath</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;./&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>如果项目部署在二级目录下，值为二级目录名，这里取名admin</p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">publicPath</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;/admin/&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>2、修改vue.config.js中的outputDir</p><p>这是打包后的文件名，默认是dist，将其设置为何上面目录名一致，即admin</p><p>3、修改router/index.js配置文件，添加base字段，值为二级目录名：admin</p><p>这里使用的是vue-router3版本</p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Router</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  mode: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;history&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 去掉url中的#</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  base: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;admin&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 二级目录路径</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  routes: constantRoutes</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h3 id="vite脚手架" tabindex="-1">vite脚手架 <a class="header-anchor" href="#vite脚手架" aria-label="Permalink to &quot;vite脚手架&quot;">​</a></h3><p>这个项目的二级目录为paasui</p><p>1、修改vite.config.js中的base</p><p>vite脚手架里publicPath改成了base</p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">base</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: process.env.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">NODE_ENV</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ===</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;production&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> ?</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;/paasui/&#39;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> :</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;/&#39;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><p>2、修改vite.config.js里的outDir</p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">build</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  outDir</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;paasui&#39;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // 指定输出路径</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>3、修改router/index.js配置文件</p><p>这里使用的事vue-router4</p><div class="language-js vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> router</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> createRouter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  history: </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">createWebHistory</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/paasui/&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  routes: constantRoutes</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>在createWebHistory/createWebHashHistory里添加二级目录名</p><h2 id="nginx配置" tabindex="-1">nginx配置 <a class="header-anchor" href="#nginx配置" aria-label="Permalink to &quot;nginx配置&quot;">​</a></h2><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>server {</span></span>
<span class="line"><span>        # 监听端口</span></span>
<span class="line"><span>        listen       100;</span></span>
<span class="line"><span>        #ip、备案过的域名、localhost</span></span>
<span class="line"><span>        server_name  192.168.4.103;</span></span>
<span class="line"><span>        # 请求路由映射，匹配拦截</span></span>
<span class="line"><span></span></span>
<span class="line"><span>            location / {</span></span>
<span class="line"><span>              # 解决history模式下，刷新报错的bug</span></span>
<span class="line"><span>              try_files $uri $uri/ /index.html;</span></span>
<span class="line"><span>              # 请求位置</span></span>
<span class="line"><span>              root E:/nginx-1.22.1/nginxRun/dist;</span></span>
<span class="line"><span>              # 首页位置</span></span>
<span class="line"><span>              index  index.html;</span></span>
<span class="line"><span>            }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>            location /paasui {</span></span>
<span class="line"><span>              # 解决history模式下，刷新报错的bug</span></span>
<span class="line"><span>              try_files $uri $uri/ /paasui/index.html;</span></span>
<span class="line"><span>              # 请求位置</span></span>
<span class="line"><span>              alias E:/nginx-1.22.1/nginxRun/paasui/;</span></span>
<span class="line"><span>              # 首页位置</span></span>
<span class="line"><span>              index  index.html;</span></span>
<span class="line"><span>            }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>            location /admin {</span></span>
<span class="line"><span>              # 解决history模式下，刷新报错的bug</span></span>
<span class="line"><span>              try_files $uri $uri/ /admin/index.html;</span></span>
<span class="line"><span>              # 请求位置</span></span>
<span class="line"><span>              alias E:/nginx-1.22.1/nginxRun/admin/;</span></span>
<span class="line"><span>              # 首页位置</span></span>
<span class="line"><span>              index  index.html;</span></span>
<span class="line"><span>            }</span></span>
<span class="line"><span>    }</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><div class="tip custom-block"><p class="custom-block-title">备注</p><p>nginx设置二级目录的时候，第一个用root，后面的用alias，并且文件夹路径最后要有/</p></div><p>启动nginx，</p><p>在浏览器输入：<a href="http://192.168.4.103:100/passui%EF%BC%8C" target="_blank" rel="noreferrer">http://192.168.4.103:100/passui，</a> 显示的passui项目</p><p><img src="`+e+'" alt="Image text"></p><p>在浏览器输入：<a href="http://192.168.4.103:100/admin%EF%BC%8C" target="_blank" rel="noreferrer">http://192.168.4.103:100/admin，</a> 显示的admin项目</p><p><img src="'+p+'" alt="Image text"></p>',35),r=[t];function h(c,d,u,k,o,b){return a(),n("div",null,r)}const E=s(l,[["render",h]]);export{g as __pageData,E as default};

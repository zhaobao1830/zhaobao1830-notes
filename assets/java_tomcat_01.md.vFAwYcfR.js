import{_ as a,o as s,c as n,R as p}from"./chunks/framework.1nBpG9uI.js";const d=JSON.parse('{"title":"集群","description":"","frontmatter":{},"headers":[],"relativePath":"java/tomcat/01.md","filePath":"java/tomcat/01.md","lastUpdated":1709689883000}'),e={name:"java/tomcat/01.md"},l=p(`<h1 id="集群" tabindex="-1">集群 <a class="header-anchor" href="#集群" aria-label="Permalink to &quot;集群&quot;">​</a></h1><p>地址：<a href="https://coding.imooc.com/lesson/162.html#mid=9011" target="_blank" rel="noreferrer">https://coding.imooc.com/lesson/162.html#mid=9011</a></p><h3 id="作用" tabindex="-1">作用 <a class="header-anchor" href="#作用" aria-label="Permalink to &quot;作用&quot;">​</a></h3><p>（一）、提高服务的性能，并发能力以及高可用性</p><p>高可用性：nginx下挂多台tomcat，当tomcat1挂掉的时候，就可以把这个节点从tomcat配置集群中摘掉，把nginx达到可用的tomcat机器上，这样就不影响提供的服务，tomcat就能带来一定的高可用性</p><p>（二）、提供项目架构的横向扩展能力</p><h3 id="实现原理" tabindex="-1">实现原理 <a class="header-anchor" href="#实现原理" aria-label="Permalink to &quot;实现原理&quot;">​</a></h3><p>通过nginx负载均衡进行请求转发</p><h3 id="负载均衡的策略和特点" tabindex="-1">负载均衡的策略和特点 <a class="header-anchor" href="#负载均衡的策略和特点" aria-label="Permalink to &quot;负载均衡的策略和特点&quot;">​</a></h3><h4 id="轮询-默认" tabindex="-1">轮询（默认） <a class="header-anchor" href="#轮询-默认" aria-label="Permalink to &quot;轮询（默认）&quot;">​</a></h4><p>优点：实现简单</p><p>缺点：不考虑每台服务器处理能力</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>upstream www.happymmall.com{</span></span>
<span class="line"><span>       </span></span>
<span class="line"><span>       server www.happymmall.com:8080;</span></span>
<span class="line"><span>       </span></span>
<span class="line"><span>       server www.happymmall.com:9080;</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h4 id="权重" tabindex="-1">权重 <a class="header-anchor" href="#权重" aria-label="Permalink to &quot;权重&quot;">​</a></h4><p>优点：考虑了每台服务器处理能力的不同</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>upstream www.happymmall.com{</span></span>
<span class="line"><span>       </span></span>
<span class="line"><span>       server www.happymmall.com:8080 weight=15;</span></span>
<span class="line"><span>       </span></span>
<span class="line"><span>       server www.happymmall.com:9080 weight=10;</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>10和15不是具体的值，只是权重，表示8080服务器是9080的1.5倍</p><h4 id="ip-hash" tabindex="-1">ip hash <a class="header-anchor" href="#ip-hash" aria-label="Permalink to &quot;ip hash&quot;">​</a></h4><p>优点：能实现同一个用户访问同一个服务器</p><p>缺点：根据ip hash不一定平均</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>upstream www.happymmall.com{</span></span>
<span class="line"><span>       </span></span>
<span class="line"><span>       ip_hash;</span></span>
<span class="line"><span>       </span></span>
<span class="line"><span>       server www.happymmall.com:8080 weight=15;</span></span>
<span class="line"><span>       </span></span>
<span class="line"><span>       server www.happymmall.com:9080 weight=10;</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="url-hash-第三方" tabindex="-1">url hash(第三方) <a class="header-anchor" href="#url-hash-第三方" aria-label="Permalink to &quot;url hash(第三方)&quot;">​</a></h4><p>优点：能实现同一个服务访问同一个服务器</p><p>缺点：根据url hash分配请求会不平均，请求频繁的url会请求到同一个服务器</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>upstream www.happymmall.com{</span></span>
<span class="line"><span>       </span></span>
<span class="line"><span>       server www.happymmall.com:8080 weight=15;</span></span>
<span class="line"><span>       </span></span>
<span class="line"><span>       server www.happymmall.com:9080 weight=10;</span></span>
<span class="line"><span>       </span></span>
<span class="line"><span>       hash $request_url;</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>比如登录和获取商品列表，这是俩个url，可以通过url hash，将url绑定到同一个服务器，之后再请求这个url，还是之前的服务器</p><p>使用url hash需要装插件</p><h4 id="fair-第三方" tabindex="-1">fair(第三方) <a class="header-anchor" href="#fair-第三方" aria-label="Permalink to &quot;fair(第三方)&quot;">​</a></h4><p>特点：按后端服务器的响应时间来分配请求，响应时间短的优先分配</p><div class="language- vp-adaptive-theme line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span>upstream www.happymmall.com{</span></span>
<span class="line"><span>       </span></span>
<span class="line"><span>       server www.happymmall.com:8080 weight=15;</span></span>
<span class="line"><span>       </span></span>
<span class="line"><span>       server www.happymmall.com:9080 weight=10;</span></span>
<span class="line"><span>       </span></span>
<span class="line"><span>       fair;</span></span>
<span class="line"><span>}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div>`,30),i=[l];function r(c,t,h,m,o,b){return s(),n("div",null,i)}const w=a(e,[["render",r]]);export{d as __pageData,w as default};
